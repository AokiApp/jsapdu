# å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ–¹é‡

**ğŸ“‹ æ³¨æ„**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ—¢å­˜ä»•æ§˜ã®**è£œå®Œ**ã§ã™ã€‚è©³ç´°ãªè¨­è¨ˆæ–¹é‡ã¯ä»¥ä¸‹ã‚’å‚ç…§ï¼š
- **è¨­è¨ˆè©³ç´°**: [android-nfc-ddd.md](../ddd/android-nfc-ddd.md) - è²¬å‹™åˆ†æ‹…ãƒ»å…¨ä½“æ§‹æˆ
- **å‘½åè¦ç´„**: [nitro-method-conventions.md](../nitro-method-conventions.md) - FFIä¸­ç«‹ãƒ»å‘½åæ–¹é‡
- **æŠ€è¡“åˆ¶ç´„**: [android-nfc-tsd.md](../tsd/android-nfc-tsd.md) - ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ»åŒæœŸãƒ»åˆ¶ç´„

---

## ğŸ“‹ ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å½¹å‰²

**æ—¢å­˜ã®åŒ…æ‹¬çš„è¨­è¨ˆä»•æ§˜**ã‚’ã€å®Ÿè£…è€…ãŒè¿·ã‚ãšé©ç”¨ã§ãã‚‹ã‚ˆã†**å®Ÿè·µçš„ãªè¦³ç‚¹**ã§æ•´ç†ã—ã¾ã™ï¼š
- **æ—¢å­˜è¨­è¨ˆ** ([android-nfc-ddd.md](../ddd/android-nfc-ddd.md)) ã®å®Ÿè£…æ™‚ã®ãƒã‚¤ãƒ³ãƒˆ
- **æ—¢å­˜å‘½åè¦ç´„** ([nitro-method-conventions.md](../nitro-method-conventions.md)) ã®å…·ä½“çš„é©ç”¨æ–¹æ³•
- **ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã®å®Ÿè·µçš„æŒ‡é‡**

å®Ÿè£…è€…ãŒè¿·ã‚ãªã„ã‚ˆã†ã€æ—¢å­˜ä»•æ§˜ã¨ã®æ•´åˆæ€§ã‚’ä¿ã¡ãªãŒã‚‰**å…·ä½“çš„ãªå®Ÿè£…æ–¹é‡**ã‚’ç¤ºã—ã¾ã™ã€‚

---

## ğŸ—ï¸ åŸºæœ¬è¨­è¨ˆæ–¹é‡

### æ–¹é‡1: Nitro Modules æ¨™æº–ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¡ç”¨

**æ±ºå®šäº‹é …**: React Native Nitro Modules ã®**æ¨™æº–çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³**ã«å¾“ã„ã¾ã™

**ç†ç”±**:
- ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®æƒ³å®šã™ã‚‹ä½¿ç”¨æ–¹æ³•ã«æ²¿ã†
- å°†æ¥çš„ãªNitro Modulesã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¸ã®è¿½å¾“ãŒå®¹æ˜“
- ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã®æ•´åˆæ€§
- ä»–ã®Nitro Modulesãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®ä¸€è²«æ€§

**å…·ä½“çš„ãªå½±éŸ¿**:
```
âœ… æ¡ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³: å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
âŒ éæ¡ç”¨: è¤‡æ•°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã‚ˆã‚‹åˆ†æ•£å®Ÿè£…
```

### æ–¹é‡2: FFIä¸­ç«‹æ€§ã®ç¶­æŒ

**æ±ºå®šäº‹é …**: å…¬é–‹APIã¯**OSå›ºæœ‰ã®æ¦‚å¿µã‚’ä¸€åˆ‡éœ²å‡ºã—ãªã„**

**ç†ç”±**:
- iOSç‰ˆå®Ÿè£…æ™‚ã®è¨­è¨ˆæ•´åˆæ€§
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¼ãƒ‰ã§ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ†å²å›é¿
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®å…±é€šåŒ–
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å˜ç´”åŒ–

**å…·ä½“çš„ãªå½±éŸ¿**:
```typescript
âœ… é©åˆ‡: SmartCardDevice.waitForCardPresence()
âŒ ä¸é©åˆ‡: AndroidNfcDevice.enableReaderMode()

âœ… é©åˆ‡: DeviceInfo.apduApi = ["nfc", "androidnfc"] 
âŒ ä¸é©åˆ‡: AndroidDeviceInfo.readerModeFlags
```

### æ–¹é‡3: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±ä¸€

**æ±ºå®šäº‹é …**: ã™ã¹ã¦ã®ä¾‹å¤–ã¯**SmartCardErrorã‚³ãƒ¼ãƒ‰ä½“ç³»**ã«æ­£è¦åŒ–

**ç†ç”±**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã§ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚³ãƒ¼ãƒ‰çµ±ä¸€
- ãƒ­ã‚°ãƒ»ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã§ã®åˆ†é¡å®¹æ˜“æ€§
- å¤šè¨€èªå¯¾å¿œã®åŸºç›¤
- ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®ä½“ç³»åŒ–

**å…·ä½“çš„ãªå½±éŸ¿**:
```kotlin
âœ… é©åˆ‡: throw SmartCardException("PLATFORM_ERROR", "NFC not supported")
âŒ ä¸é©åˆ‡: throw IOException("NFC adapter not found")
```

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆæ–¹é‡

### TypeScriptå´: è²¬å‹™åˆ†é›¢ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

**æ±ºå®šäº‹é …**: **è²¬å‹™ã«å¿œã˜ãŸé©åˆ‡ãªãƒ•ã‚¡ã‚¤ãƒ«åˆ†é›¢**

```
src/
â”œâ”€â”€ JsapduRn.nitro.ts           # Nitroã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ device-info.ts          # ãƒ‡ãƒã‚¤ã‚¹é–¢é€£å‹å®šç¾©
â”‚   â””â”€â”€ apdu.ts                  # APDUé–¢é€£å‹å®šç¾©
â”œâ”€â”€ platform/
â”‚   â””â”€â”€ smart-card-platform.ts  # ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å®Ÿè£…
â”œâ”€â”€ device/
â”‚   â””â”€â”€ smart-card-device.ts    # ãƒ‡ãƒã‚¤ã‚¹å®Ÿè£…
â”œâ”€â”€ card/
â”‚   â””â”€â”€ smart-card.ts           # ã‚«ãƒ¼ãƒ‰å®Ÿè£…
â”œâ”€â”€ errors/
â”‚   â””â”€â”€ error-mapper.ts         # ã‚¨ãƒ©ãƒ¼æ­£è¦åŒ–ãƒ­ã‚¸ãƒƒã‚¯
â””â”€â”€ index.tsx                   # å…¬é–‹APIã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

**ç†ç”±**:
- **å˜ä¸€è²¬ä»»åŸå‰‡** (SRP) ã®éµå®ˆ
- **ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§**: å„ã‚¯ãƒ©ã‚¹ã®ç‹¬ç«‹ãƒ†ã‚¹ãƒˆå¯èƒ½
- **ä¿å®ˆæ€§**: å¤‰æ›´å½±éŸ¿ç¯„å›²ã®å±€æ‰€åŒ–
- **æ‹¡å¼µæ€§**: æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®å½±éŸ¿æœ€å°åŒ–
- **ãƒãƒ¼ãƒ é–‹ç™º**: ä¸¦è¡Œé–‹ç™ºãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼åŠ¹ç‡åŒ–

### Kotlinå´: è²¬å‹™åˆ¥ã‚¯ãƒ©ã‚¹åˆ†é›¢æ–¹å¼

**æ±ºå®šäº‹é …**: **è²¬å‹™åˆ¥ã®å®Œå…¨åˆ†é›¢ã‚¯ãƒ©ã‚¹æ§‹æˆ**

```
android/src/main/java/.../
â”œâ”€â”€ JsapduRn.kt                    # Nitroã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ (å§”è­²ã®ã¿)
â”œâ”€â”€ platform/
â”‚   â””â”€â”€ SmartCardPlatformImpl.kt   # ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å®Ÿè£…
â”œâ”€â”€ device/
â”‚   â””â”€â”€ SmartCardDeviceImpl.kt     # ãƒ‡ãƒã‚¤ã‚¹ãƒ»ReaderModeç®¡ç†
â”œâ”€â”€ card/
â”‚   â””â”€â”€ SmartCardImpl.kt           # ã‚«ãƒ¼ãƒ‰ãƒ»IsoDepç®¡ç†
â””â”€â”€ errors/
    â””â”€â”€ AndroidErrorMapper.kt      # Androidä¾‹å¤–â†’SmartCardErrorå¤‰æ›
```

**ç†ç”±**:
- **é–¢å¿ƒäº‹ã®åˆ†é›¢**: å„ã‚¯ãƒ©ã‚¹ãŒå˜ä¸€ã®è²¬å‹™ã«é›†ä¸­
- **ãƒ†ã‚¹ãƒˆæˆ¦ç•¥**: å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç‹¬ç«‹ãƒ†ã‚¹ãƒˆ
- **ä¿å®ˆæ€§å‘ä¸Š**: å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²æ˜ç¢ºåŒ–
- **ä¸¦è¡Œé–‹ç™º**: è¤‡æ•°é–‹ç™ºè€…ã«ã‚ˆã‚‹åŒæ™‚ä½œæ¥­æ”¯æ´

**å®Ÿè£…ãƒ«ãƒ¼ãƒ«**:
```kotlin
âœ… é©åˆ‡: JsapduRn ã¯ç´”ç²‹ãªå§”è­²å±¤
override fun initPlatform() = Promise.async {
    platformImpl.initialize(reactContext)
}

âŒ ä¸é©åˆ‡: JsapduRn ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
override fun initPlatform() = Promise.async {
    val adapter = NfcAdapter.getDefaultAdapter(reactContext) // è²¬å‹™æ··åœ¨
}
```

---

## ğŸ”Œ ä¾å­˜é–¢ä¿‚ç®¡ç†æ–¹é‡

### æ–¹é‡1: æœ€å°é™ä¾å­˜ã®åŸå‰‡

**æ±ºå®šäº‹é …**: å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¾å­˜ã‚’**æœ€å°é™**ã«ç•™ã‚ã‚‹

**è¨±å¯ã™ã‚‹ä¾å­˜**:
```kotlin
âœ… Android Standard Library (android.nfc.*)
âœ… React Native Core (com.facebook.react.*)
âœ… Nitro Modules (com.margelo.nitro.*)
```

**ç¦æ­¢ã™ã‚‹ä¾å­˜**:
```kotlin
âŒ ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£NFCãƒ©ã‚¤ãƒ–ãƒ©ãƒª
âŒ è¿½åŠ ã®JSONãƒ©ã‚¤ãƒ–ãƒ©ãƒª
âŒ ãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (React Nativeã®æ¨™æº–ã‚’ä½¿ç”¨)
âŒ éå¿…é ˆã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
```

**ç†ç”±**: ã‚¢ãƒ—ãƒªã‚µã‚¤ã‚ºå¢—å¤§ã®å›é¿ã€ä¾å­˜é–¢ä¿‚ç«¶åˆã®å›é¿ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ä½æ¸›

### æ–¹é‡2: ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šã®åŸå‰‡

**æ±ºå®šäº‹é …**: é‡è¦ãªä¾å­˜é–¢ä¿‚ã¯**ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š**

```json
// package.json
{
  "dependencies": {
    "react-native-nitro-modules": "0.31.1"  // å›ºå®š
  },
  "peerDependencies": {
    "react-native": ">=0.74.0"  // æœ€å°ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š
  }
}
```

**ç†ç”±**: äºˆæœŸã—ãªã„Breaking Changeså›é¿ã€ãƒ“ãƒ«ãƒ‰å†ç¾æ€§ç¢ºä¿

---

## ğŸ§µ ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ»ä¸¦è¡Œæ€§æ–¹é‡

### æ–¹é‡1: UI Threadå®Œå…¨å›é¿

**æ±ºå®šäº‹é …**: NFC I/Oã¯**UI Threadä»¥å¤–ã§å®Ÿè¡Œ**ã‚’å³å®ˆ

**å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```kotlin
âœ… é©åˆ‡: Promise.async { } å†…ã§I/Oå®Ÿè¡Œ
override fun transmit(apdu: ArrayBuffer): Promise<Map<String, Any?>> = Promise.async {
    // ã“ã“ã¯Background Threadã§å®Ÿè¡Œã•ã‚Œã‚‹
    isoDep.transceive(command)
}

âŒ ä¸é©åˆ‡: åŒæœŸãƒ¡ã‚½ãƒƒãƒ‰ã§I/Oå®Ÿè¡Œ
override fun transmitSync(apdu: ArrayBuffer): Map<String, Any?> {
    return isoDep.transceive(command) // UI Threadãƒ–ãƒ­ãƒƒã‚¯ã®å±é™º
}
```

### æ–¹é‡2: æ’ä»–åˆ¶å¾¡ã®å±€æ‰€åŒ–

**æ±ºå®šäº‹é …**: æ’ä»–åˆ¶å¾¡ã¯**ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹å†…éƒ¨**ã§å®Œçµ

```kotlin
class SmartCardDeviceManager {
    private val mutex = Mutex() // æ’ä»–åˆ¶å¾¡ã¯ã“ã“ã§å®Œçµ
    
    suspend fun acquire(...) = mutex.withLock {
        // æ’ä»–åˆ¶å¾¡ãŒå¿…è¦ãªå‡¦ç†
    }
}

// JsapduRn.kt ã§ã¯æ’ä»–åˆ¶å¾¡ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ãªã„
override fun acquireDevice(deviceId: String) = Promise.async {
    deviceManager.acquire(deviceId, ...) // å§”è­²ã™ã‚‹ã®ã¿
}
```

**ç†ç”±**: è¤‡é›‘æ€§ã®å±€æ‰€åŒ–ã€ãƒ†ã‚¹ãƒˆã®å®¹æ˜“æ€§ã€ãƒã‚°æ··å…¥ãƒªã‚¹ã‚¯ä½æ¸›

---

## ğŸ”„ ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†æ–¹é‡

### æ–¹é‡1: RAII (Resource Acquisition Is Initialization) ãƒ‘ã‚¿ãƒ¼ãƒ³

**æ±ºå®šäº‹é …**: ãƒªã‚½ãƒ¼ã‚¹å–å¾—ã¨è§£æ”¾ã‚’**å¯¾ç§°çš„**ã«è¨­è¨ˆ

```typescript
// å¯¾ç§°çš„ãªãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
await SmartCardPlatform.init()        // å–å¾—
await SmartCardPlatform.release()     // è§£æ”¾

const device = await platform.acquireDevice(id)  // å–å¾—  
await device.release()                           // è§£æ”¾

const card = await device.startSession()  // å–å¾—
await card.release()                      // è§£æ”¾
```

**å¼·åˆ¶ãƒ«ãƒ¼ãƒ«**:
- ã™ã¹ã¦ã® `acquire` ç³»ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯å¯¾å¿œã™ã‚‹ `release` ã‚’ç”¨æ„
- `release` ã¯å†ªç­‰æ€§ã‚’ä¿è¨¼ï¼ˆè¤‡æ•°å›å‘¼ã‚“ã§ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ï¼‰
- ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯é˜²æ­¢ã®ãŸã‚ã€finalizerçš„ãªä»•çµ„ã¿ã‚‚ä½µç”¨

### æ–¹é‡2: ä¾‹å¤–å®‰å…¨æ€§ã®ä¿è¨¼

**æ±ºå®šäº‹é …**: ä¾‹å¤–ç™ºç”Ÿæ™‚ã§ã‚‚**ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ã—ãªã„**è¨­è¨ˆ

```kotlin
class SmartCardManager {
    fun startSession(tag: Tag) {
        val isoDep = IsoDep.get(tag)
        try {
            isoDep.connect()
            this.isoDep = isoDep
            isActive = true
        } catch (e: Exception) {
            isoDep.close() // ä¾‹å¤–æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            throw SmartCardException("PLATFORM_ERROR", e.message)
        }
    }
}
```

---

## ğŸ“ æ€§èƒ½ãƒ»åˆ¶ç´„æ–¹é‡

### æ–¹é‡1: ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ€§èƒ½ã®åŸºæº–

**æ±ºå®šäº‹é …**: ä»¥ä¸‹ã®æ€§èƒ½åŸºæº–ã‚’**å¿…é ˆè¦ä»¶**ã¨ã™ã‚‹

```
âœ… å¿…é ˆåŸºæº–:
- init(): < 1000ms
- getDeviceInfo(): < 100ms  
- acquireDevice(): < 500ms
- transmit(): < 3000ms (APDU dependent)
- releaseç³»: < 200ms

âš ï¸ æ³¨æ„äº‹é …:
- waitForCardPresence(): ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œä¾å­˜ã®ãŸã‚ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§åˆ¶å¾¡
- æ¸¬å®šã¯ä¸­ä½æ€§èƒ½ç«¯æœ« (Snapdragon 660ç›¸å½“) ã§å®Ÿæ–½
```

### æ–¹é‡2: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡åˆ¶é™

**æ±ºå®šäº‹é …**: ä»¥ä¸‹ã®ãƒ¡ãƒ¢ãƒªåˆ¶é™ã‚’**è¨­è¨ˆåŸå‰‡**ã¨ã™ã‚‹

```
âœ… åˆ¶é™å€¤:
- ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå®Ÿè£…: < 5MB (å¸¸é§)
- APDU ãƒãƒƒãƒ•ã‚¡: < 100KB (ä¸€æ™‚)
- ãƒ­ã‚°ãƒãƒƒãƒ•ã‚¡: < 1MB (é–‹ç™ºæ™‚ã®ã¿)

âœ… å¯¾ç­–:
- å¤§ããªãƒãƒƒãƒ•ã‚¡ã®å³åº§è§£æ”¾
- WeakReferenceæ´»ç”¨
- Staticå¤‰æ•°ã®æœ€å°åŒ–
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹é‡

### æ–¹é‡1: ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®é©ç”¨

**æ±ºå®šäº‹é …**: **å˜ä½“ãƒ†ã‚¹ãƒˆé‡ç‚¹ã€çµ±åˆãƒ†ã‚¹ãƒˆè£œå®Œ**ã®æ§‹é€ 

```
ğŸ”¼ æ‰‹å‹•ãƒ†ã‚¹ãƒˆ (å°‘): å®Ÿæ©Ÿã§ã®ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰æ¤œè¨¼
ğŸ”³ çµ±åˆãƒ†ã‚¹ãƒˆ (ä¸­): ãƒ¢ãƒƒã‚¯ç’°å¢ƒã§ã®å…¨ä½“ãƒ•ãƒ­ãƒ¼
ğŸ”º å˜ä½“ãƒ†ã‚¹ãƒˆ (å¤š): å„ã‚¯ãƒ©ã‚¹ã®å€‹åˆ¥æ©Ÿèƒ½
```

**å…·ä½“çš„æ¯”ç‡**:
- å˜ä½“ãƒ†ã‚¹ãƒˆ: 70% (å„ãƒ¡ã‚½ãƒƒãƒ‰ã®æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»)
- çµ±åˆãƒ†ã‚¹ãƒˆ: 25% (ã‚¯ãƒ©ã‚¹é–“é€£æºãƒ»ã‚¨ãƒ©ãƒ¼ä¼æ’­)
- æ‰‹å‹•ãƒ†ã‚¹ãƒˆ: 5% (å®Ÿéš›ã®NFCã‚«ãƒ¼ãƒ‰ã§ã®å‹•ä½œç¢ºèª)

### æ–¹é‡2: ãƒ¢ãƒƒã‚¯æˆ¦ç•¥

**æ±ºå®šäº‹é …**: **Android NFC API ã®ã¿ãƒ¢ãƒƒã‚¯**ã€Nitroéƒ¨åˆ†ã¯ãã®ã¾ã¾

```kotlin
âœ… ãƒ¢ãƒƒã‚¯å¯¾è±¡:
- NfcAdapter
- IsoDep  
- Tag

âŒ ãƒ¢ãƒƒã‚¯å¯¾è±¡å¤–:
- Promise (Nitro Modules)
- SmartCardError (è‡ªä½œã‚¯ãƒ©ã‚¹)
- ArrayBuffer (æ¨™æº–ã‚¯ãƒ©ã‚¹)
```

**ç†ç”±**: Nitroå›ºæœ‰ã®å•é¡Œã¨NFCå›ºæœ‰ã®å•é¡Œã‚’åˆ†é›¢ã€ãƒ†ã‚¹ãƒˆä¿¡é ¼æ€§å‘ä¸Š

---

## ğŸ“‹ ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### å‘½åè¦ç´„

```kotlin
âœ… ã‚¯ãƒ©ã‚¹å: PascalCase
class SmartCardPlatformManager

âœ… ãƒ¡ã‚½ãƒƒãƒ‰å: camelCase  
fun initializePlatform()

âœ… å®šæ•°: UPPER_SNAKE_CASE
companion object {
    private const val DEFAULT_TIMEOUT_MS = 15000L
}

âœ… ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆå¤‰æ•°: camelCase with prefix
private var isInitialized = false
```

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¦ç´„

```kotlin
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: æ—¥æœ¬èªã€è§£æ±ºç­–æç¤º
throw SmartCardException("PLATFORM_ERROR", 
    "NFCãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚NFCå¯¾å¿œç«¯æœ«ã§ãŠè©¦ã—ãã ã•ã„ã€‚")

âœ… é–‹ç™ºè€…å‘ã‘ãƒ­ã‚°: è‹±èªã€æŠ€è¡“è©³ç´°
Log.d(TAG, "NfcAdapter.getDefaultAdapter() returned null")
```

---

## ğŸ”„ å¤‰æ›´ç®¡ç†æ–¹é‡

### æ–¹é‡1: Breaking Change æœ€å°åŒ–

**æ±ºå®šäº‹é …**: å…¬é–‹APIã®**Breaking Changes ã¯æ¥µåŠ›å›é¿**

```typescript
âœ… å®‰å…¨ãªå¤‰æ›´:
- æ–°ã—ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°ã®è¿½åŠ 
- æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿½åŠ   
- å†…éƒ¨å®Ÿè£…ã®æœ€é©åŒ–

âŒ å±é™ºãªå¤‰æ›´:
- æ—¢å­˜ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°å¤‰æ›´
- æˆ»ã‚Šå€¤å‹ã®å¤‰æ›´
- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³»ã®å¤‰æ›´
```

### æ–¹é‡2: æ®µéšçš„ç§»è¡Œã‚µãƒãƒ¼ãƒˆ

**æ±ºå®šäº‹é …**: å¤§ããªå¤‰æ›´ã¯**Deprecation â†’ å‰Šé™¤**ã®æ®µéšã‚’è¸ã‚€

```typescript
// ä¾‹: ãƒ¡ã‚½ãƒƒãƒ‰åå¤‰æ›´ã®å ´åˆ
class SmartCardPlatform {
  // æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰
  static async initialize(): Promise<void> { ... }
  
  // å¤ã„ãƒ¡ã‚½ãƒƒãƒ‰ (Deprecated)
  /** @deprecated Use initialize() instead */
  static async init(): Promise<void> {
    console.warn('SmartCardPlatform.init() is deprecated. Use initialize() instead.');
    return this.initialize();
  }
}
```

---

## âœ… å®Ÿè£…å®Œäº†åŸºæº–

ä»¥ä¸‹ã™ã¹ã¦ãŒæº€ãŸã•ã‚ŒãŸå ´åˆã«**å®Ÿè£…å®Œäº†**ã¨ã—ã¾ã™ï¼š

### å¿…é ˆåŸºæº–
- [ ] ã™ã¹ã¦ã®public APIãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ > 80%
- [ ] æ€§èƒ½åŸºæº–ã‚’ã™ã¹ã¦ã‚¯ãƒªã‚¢
- [ ] ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚’ãƒ‘ã‚¹
- [ ] å®Ÿæ©Ÿã§ã®åŸºæœ¬å‹•ä½œç¢ºèªå®Œäº†

### å“è³ªåŸºæº–  
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´åˆæ€§ç¢ºèª
- [ ] é™çš„è§£æã‚¨ãƒ©ãƒ¼ã‚¼ãƒ­
- [ ] ESLint/Ktlint ã‚¨ãƒ©ãƒ¼ã‚¼ãƒ­
- [ ] å‹å®‰å…¨æ€§æ¤œè¨¼å®Œäº†

### å‡ºè·åŸºæº–
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†  
- [ ] å®Ÿæ©Ÿäº’æ›æ€§ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Œäº†

---

**ã“ã®æ–¹é‡ã«å¾“ã†ã“ã¨ã§ã€ä¿å®ˆå¯èƒ½ã§æ‹¡å¼µã—ã‚„ã™ã„é«˜å“è³ªãªå®Ÿè£…ã‚’å®Ÿç¾ã—ã¾ã™ã€‚**